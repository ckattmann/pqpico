<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<script src="https://code.jquery.com/jquery-1.11.2.min.js"></script>
<script src="http://code.highcharts.com/highcharts.js"></script>
</head>
<body>
<div id="maingraph"></div>
<script>
    var vdata = [];
    console.log('Script');
    jQuery(document).ready(function($) {
        console.log('Jquery');

        $.getJSON("jsondata/frequency.json", function(data) {
            console.log('getJSON');
            vdata = data.freq;
            console.log(vdata);
            
            $('#maingraph').highcharts({
                chart: {
                    type: 'line',
                    events: {
                        load: function() {
                            console.log("$(this):");
                            console.log($(this));
                            console.log(this.series);
                            console.log(this.series[0]);
                            console.log(this.series[0].data);
                            console.log(oldData);
                            var oldData = $(this).series[0].data;
                            setInterval(function() {
                                $.getJSON("jsondata/frequency.json", function(data) {
                                     var vdata = data.freq;
                                     console.log('Received Data: '+vdata);
                                     console.log('Series: '+oldData);
                                    //extract more data
                                    });
                                if (vdata.length > oldData.length)
                                {
                                    var i = oldData.length;
                                    for (; i < vdata.length; i++)
                                    {
                                        oldData.addPoint(vdata[i],true,false,true);
                                        console.log('Adding point: '+vdata[i])
                                    }
                                }
                            } ,10000);
                        },
                    }
                },
                title: {
                    text: 'Frequency 10 seconds average'
                },
                xAxis: {
                    type:'datetime'
                },
                yAxis: {
                    title: {
                        text: 'Frequency / Hz',
                    },
                    plotBands: [{
                            color: '#80B192',
                            from: 49.8,
                            to: 50.2}]
                },
                series: [{
                    name: 'frequency',
                    data: vdata,
                    pointInterval : 10000 //10 seconds
                }]
            });
    });
});

</script>
</body>
</html>
