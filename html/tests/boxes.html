<html>

<head>
    <meta charset="UTF-8">
    <link rel='stylesheet' type='text/css' href='boxes.css'></link>
</head>

<body>
<div id='header'>
    <ul>
        <li class='menupoint'><a class='menulink linkStatus' href="" onclick="return false;">Status</a></li>
        <li class='menupoint'><a class='menulink linkFrequency' href="" onclick="return false;">Frequenz</a></li>
        <li class='menupoint'><a class='menulink linkVoltage' href="" onclick="return false;">Spannung</a></li>
        <li class='menupoint'><a class='menulink linkHarmonics' href="" onclick="return false;">Harmonische</a></li>
        <li class='menupoint'><a class='menulink linkFlicker' href="" onclick="return false;">Flicker</a></li>
    </ul>
</div>

<div class='container'>
    <!-- Big Boxes for main graphs -->
    <div class='box bigbox voltageGraph'>
        
    </div>
    <div class='box bigbox frequencyGraph'>
        
    </div>
    <div class='box bigbox harmonicsGraph'>
        
    </div>
    <div class='box bigbox flickerGraph'>
        
    </div>
    <!-- Smaller info boxes below main graph -->
    <div class='box smallbox snippetsizeBox'>

    </div>
    <div class='box smallbox statusBox'>
        <div class=statusOK>Messung aktiv</div>
    </div>
    <div class='box smallbox freqBox'>
        Frequency
    </div>
    <div class='box smallbox voltBox'>
        Voltage
    </div>
    <div class='box smallbox harmBox'>
        harmonics
    </div>
    <div class='box smallbox flickerBox'>
        Flicker
    </div>
    <div class='box smallbox waveBox'>
        Waveform
    </div>
    <div class='box smallbox thdBox'>
        THD
    </div>
</div>

<!-- Footer Bar -->
<div class="graybar bottom">
    <ul id="footer">
        <li><a href="http://github.com/mischele">MB</a> |
            <a href="http://github.com/kanell">MG</a> |
            <a href="http://github.com/kipfer">CK</a> |
            <a href="http://www.uni-stuttgart.de/ieh">IEH</a></li>
    </ul>
</div>

<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.2/jquery.min.js"></script>
<script src="http://code.highcharts.com/highcharts.js"></script>
<script>
jQuery(document).ready(function($) {
        // Initialize Graphs
        $('.snippetsizeBox').highcharts({
            chart: {animation: false},
            plotOptions: { series: {color: '#FF3005', marker: {enabled: false}}},
            title: {text: 'Microseconds for Computation'},
            subtitle: {text: '10 Perioden-Mittelwerte'},
            legend: {enabled: false},
            series: [{data: [] }],
            tooltip: {enabled: false}
            }).hide();

        $('.voltageGraph').highcharts({
            chart: {animation: false},
            plotOptions: { series: {color: '#FF3005', marker: {enabled: false}}},
            title: {text: 'Spannung / V'},
            subtitle: {text: '10 Perioden-Mittelwerte'},
            legend: {enabled: false},
            series: [{data: [] }],
            tooltip: {enabled: false}
            }).hide();

        $('.frequencyGraph').highcharts({
            chart: {animation: false},
            plotOptions: { series: {color: '#08417C', marker: {enabled: false}}},
            legend: {enabled: false},
            series: [{data: [] }]
            }).hide();

        $('.harmonicsGraph').highcharts({
            chart: {animation: true, type: 'column'},
            plotOptions: { series: {color: '#08417C', marker: {enabled: false}}},
            xAxis: { categories: ['2','3','4','5','6','7','8','9','10','11','12','13','14','15','16','17','18','19','20','21','22','23','24','25','26','27','28','29','30','31','32','33','34','35','36','37','38','39','40']},
            legend: {enabled: false},
            series: [{data: [] }]
            }).hide();

        $('.waveBox').highcharts({
            chart: {animation: true},
            plotOptions: { series: {color: '#08417C', marker: {enabled: false}}},
            title: {text: 'Wellenform'},
            legend: {enabled: false},
            series: [{data: [] }],
            tooltip: {enabled: false}
            }).hide();

        $('.thdBox').highcharts({
            chart: {animation: false},
            plotOptions: { series: {color: '#08417C', marker: {enabled: false}}},
            title: {text: 'Total Harmonic Distortion'},
            legend: {enabled: false},
            series: [{data: [] }],
            tooltip: {enabled: false}
            }).hide();

        function clearView() {
            $('.menulink').removeClass('selected');
            $('.box').hide();
        };
        
        // Navigation
        $('.linkStatus').click(function() {
            clearView();
            $('.linkStatus').addClass('selected');
            $('.statusBox').fadeIn(2000);
            $('.snippetsizeBox').show();

            var snippetsizeGraph = $('.snippetsizeBox').highcharts();
            updateGraph(snippetsizeGraph,'jsondata/snippetsize.json','Snippet Size');

        });
        $('.linkFrequency').click(function() {
            clearView();
            $('.linkFrequency').addClass('selected');
            $('.freqBox').show();
            $('.frequencyGraph').show();
            $('div#header').css('background-color','#08417C');

            var frequencyGraph = $('.frequencyGraph').highcharts();
            updateGraph(frequencyGraph,'jsondata/frequency.json','Frequenz');
        });
        $('.linkVoltage').click(function() {
            clearView();
            $('.linkVoltage').addClass('selected');
            $('.voltageGraph').show();
            $('.voltBox').fadeIn(200);
            $('div#header').css('background-color','#BF2100');

            var voltageGraph = $('.voltageGraph').highcharts();
            updateGraph(voltageGraph,'jsondata/voltage.json','Spannung');
        });
        $('.linkHarmonics').click(function() {
            clearView();
            $('.linkHarmonics').addClass('selected');
            $('.harmonicsGraph').show();
            $('.harmBox').fadeIn(200);
            $('.waveBox').show()
            $('.thdBox').show()

            var harmonicsGraph = $('.harmonicsGraph').highcharts();
            updateGraph(harmonicsGraph, 'jsondata/harmonics.json', 'Harmonische');

            var waveGraph = $('.waveBox').highcharts();
            updateGraph(waveGraph, 'jsondata/waveform.json','Spannung');

            var thdGraph = $('.thdBox').highcharts();
            updateGraph(thdGraph, 'jsondata/thd.json','THD');
        });
        $('.linkFlicker').click(function() {
            clearView();
            $('.smallbox').hide();
            $('.box3').fadeIn(200);
            var mainchart = $('.flickerGraph').highcharts();
        });

        function updateGraph(chart,pathString,nameString) {
            chart.series[0].remove();
            chart.addSeries({name: nameString, data:[] });
            function updateGraphRepeater() {
                $.getJSON(pathString, function(data) {
                    data = data.values;
                    chart.series[0].setData(data)
                    setTimeout(updateGraphRepeater,1000);
                });
            }
            updateGraphRepeater();
        }

});

</script>

</body>
</html>
