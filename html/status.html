<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<script src="https://code.jquery.com/jquery-1.11.2.min.js"></script>
<script src="http://code.highcharts.com/highcharts.js"></script>
</head>
<body>
<div id="maingraph"></div>
<script>
    var vdata = [];
    console.log('Script');
    jQuery(document).ready(function($) {
        console.log('Jquery');

        $.getJSON("jsondata/data.json", function(data) {
            console.log('getJSON');
            console.log(data);
            vdata = data.data;
            
            $('#maingraph').highcharts({
                chart: {
                    type: 'line',
                    events: {
                        load: function() {
                            var series = this.series[0];
                            setInterval(function() {
                                $.getJSON("jsontest/data.json", function(data) {
                                    console.log(data.data);
                                    vdata = data.data;
                                    //extract more data
                                    });
                                if (vdata.length > series.data.length)
                                {
                                    var i = series.data.length;
                                    for (; i < vdata.length; i++)
                                    {
                                        series.addPoint(vdata[i],true,false,true);
                                    }
                                }
                            }
                                ,1000);
                        },
                    }
                },
                title: {
                    text: 'RMS Voltage of 10 periods'
                },
                xAxis: {
                    type:'datetime'
                },
                yAxis: {
                    title: {
                        text: 'Voltage / V',
                    },
                    plotBands: [{
                            color: '#80B192',
                            from: 49.8,
                            to: 50.2}]
                },
                series: [{
                    name: 'Voltage',
                    data: vdata,
                    pointInterval : 10000 //10 seconds
                }]
            });
    });
});

</script>
</body>
</html>
